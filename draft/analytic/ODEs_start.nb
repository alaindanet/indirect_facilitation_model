(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53127,       1292]
NotebookOptionsPosition[     52290,       1264]
NotebookOutlinePosition[     52646,       1280]
CellTagsIndexPosition[     52603,       1277]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"2015", "-", "07", "-", "16"}], ":", " ", 
      RowBox[{"Here", " ", "is", " ", "a", " ", "Mathematica", " ", 
       RowBox[{
        RowBox[{"script", "/", "slash"}], "/", "notebook"}], " ", "for", " ", 
       "playing", " ", "around", " ", "with", " ", "Ordinary", " ", 
       "Differential", " ", "Equations", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"closed", " ", "form"}], ")"}], ".", "Features"}]}], ":"}], 
     "  ", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "input"}], " ", "your", " ", "custom", " ", 
      RowBox[{"ODE", "'"}], "s", " ", 
      RowBox[{"(", 
       RowBox[{"closed", " ", "form"}], ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "get"}], " ", "a", " ", "formal", " ", "expression", " ", 
      "of", " ", "the", " ", "equilibria"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "get"}], " ", "a", " ", "formal", " ", "expression", " ", 
      "of", " ", "the", " ", "Jacobian", " ", "matrix"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "get"}], " ", "a", " ", "formal", " ", "expression", " ", 
      "of", " ", "the", " ", "eigenvalues"}]}], ",", 
    RowBox[{
     RowBox[{
     "evaluated", " ", "in", " ", "the", " ", "various", " ", "equilibria"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "explore"}], " ", "and", " ", "simplify", " ", "the", " ", 
      "conditions", " ", "of", " ", "positivity", " ", "of", " ", "the", " ", 
      "equilibria", " ", "and", " ", "their", " ", "stability"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "plot"}], " ", "any", " ", "trajectory", " ", "against", 
      " ", "time"}]}], ",", 
    RowBox[{"manipulate", " ", "parameters"}], ",", 
    RowBox[{
     RowBox[{"also", " ", "plot", " ", "the", " ", "equilibria"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"-", "plot"}], " ", "any", " ", "trajectory", " ", "in", " ", 
      "the", " ", "space", " ", "phase", " ", "up", " ", "to", " ", "5", " ", 
      "dimensions"}]}], ",", 
    RowBox[{"also", " ", "plot", " ", "the", " ", "equilibria", " ", 
     RowBox[{"(", 
      RowBox[{
      "TODO", " ", "and", " ", "adapt", " ", "depending", " ", "on", " ", 
       "what", " ", "you", " ", 
       RowBox[{"need", "'"}], "a", " ", "see"}], ")"}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Several", " ", "options", " ", "I", " ", "like"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"Manipulate", ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
      RowBox[{"Paneled", "\[Rule]", "False"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"Manipulator", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"ParametricPlot3D", ",", 
      RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"done", "=", 
     RowBox[{"Sound", "[", 
      RowBox[{"{", 
       RowBox[{"Play", "[", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"500", " ", "t", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"t", "^", "4"}]}], ")"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1.85"}], "}"}]}], "]"}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"SetDirectory", "[", "\"\<~/Danet/\>\"", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6460498678519897`*^9, 3.6460498966577044`*^9}, {
   3.646050130380447*^9, 3.646050163242231*^9}, {3.646050313376522*^9, 
   3.646050314407921*^9}, {3.6460516418563433`*^9, 3.646051642828989*^9}, {
   3.6461020155043697`*^9, 3.6461020886300583`*^9}, {3.6461022091702137`*^9, 
   3.6461022673527393`*^9}, {3.646102313625555*^9, 3.6461023212023697`*^9}, 
   3.646102396228836*^9, {3.646112219030696*^9, 3.646112221047483*^9}, {
   3.646115550408801*^9, 3.64611557942883*^9}, {3.646129492841364*^9, 
   3.6461294940630293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Input", ":", " ", 
    RowBox[{"Here", " ", "are", " ", "your", " ", "favorite", " ", 
     RowBox[{"ODE", "'"}], "s"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Name", " ", "for", " ", "the", " ", "variables"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"varNames", " ", "=", 
     RowBox[{"{", 
      RowBox[{
      "\[Rho]n", ",", "\[Rho]p", ",", "\[Rho]nn", ",", "\[Rho]pp", ",", 
       "\[Rho]np"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Nice", " ", "names", " ", "for", " ", "displaying"}], ",", " ", 
     
     RowBox[{"(", 
      RowBox[{
      "which", " ", "are", " ", "not", " ", "necessarily", " ", "the", " ", 
       "same"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"niceNames", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(N\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(P\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(NN\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(PP\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Rho]\), \(NP\)]\)\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Number", " ", "of", " ", "dimensions"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nDims", "=", 
     RowBox[{"Length", "@", "varNames"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"List", " ", "your", " ", 
     RowBox[{"equations", ":", " ", 
      RowBox[{"derivative", " ", "for", " ", "each", " ", 
       RowBox[{"variable", "?"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ODEs", "=", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"\[CapitalRho]0", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Delta]", " ", "\[Rho]n"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Delta]"}], ")"}], 
             FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"b", "-", 
            RowBox[{"cn", " ", 
             FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}], "-", 
            RowBox[{"cpn", " ", 
             FractionBox["\[CapitalRho]p", "\[CapitalRho]0"]}]}], ")"}]}], 
         "-", 
         RowBox[{"m", " ", "\[Rho]n"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[CapitalRho]0", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Delta]", " ", "\[Rho]p"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", 
             FractionBox["\[CapitalRho]p", "\[CapitalRho]0"]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"b", "-", 
            RowBox[{"cp", " ", 
             FractionBox["\[CapitalRho]p", "\[CapitalRho]0"]}], "-", 
            RowBox[{"cnp", " ", 
             FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}], "-", 
            RowBox[{"g", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"n", 
                FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}]}], 
              ")"}]}]}], ")"}]}], "-", 
         RowBox[{"m", " ", "\[Rho]p"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"2", "\[CapitalRho]n", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Delta]", " ", "\[Rho]n"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Delta]"}], ")"}], " ", 
             FractionBox["1", "z"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Delta]"}], ")"}], 
             FractionBox[
              RowBox[{"(", 
               RowBox[{"z", "-", "1"}], ")"}], "z"], 
             FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"b", "-", 
            RowBox[{"cn", 
             FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}], "-", 
            RowBox[{"cpn", " ", 
             FractionBox["\[CapitalRho]p", "\[CapitalRho]0"]}]}], ")"}]}], 
         "-", 
         RowBox[{"2", "m", " ", "\[Rho]nn"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"2", "\[CapitalRho]p", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Delta]", " ", "\[Rho]p"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Delta]"}], ")"}], 
             FractionBox["1", "z"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Delta]"}], ")"}], 
             FractionBox[
              RowBox[{"z", "-", "1"}], "z"], 
             FractionBox["\[CapitalRho]p", "\[CapitalRho]0"]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"b", "-", 
            RowBox[{"cp", " ", 
             FractionBox["\[CapitalRho]p", "\[CapitalRho]0"]}], "-", 
            RowBox[{"cnp", " ", 
             FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}], "-", 
            RowBox[{"g", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"n", 
                FractionBox[
                 RowBox[{"z", "-", "1"}], "z"], " ", 
                FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}]}], 
              ")"}]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", "m", " ", "\[Rho]pp"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[CapitalRho]p", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Delta]", " ", "\[Rho]n"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Delta]"}], ")"}], 
             FractionBox[
              RowBox[{"z", "-", "1"}], "z"], 
             FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"b", "-", 
            RowBox[{"cn", " ", 
             FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}], "-", 
            RowBox[{"cpn", " ", 
             FractionBox["\[CapitalRho]p", "\[CapitalRho]0"]}]}], ")"}]}], 
         "+", 
         RowBox[{"\[CapitalRho]n", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Delta]", " ", "\[Rho]p"}], " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Delta]"}], ")"}], 
             FractionBox[
              RowBox[{"z", "-", "1"}], "z"], 
             FractionBox["\[CapitalRho]p", "\[CapitalRho]0"]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"b", " ", "-", 
            RowBox[{"cp", " ", 
             FractionBox["\[CapitalRho]p", "\[CapitalRho]0"]}], "-", 
            RowBox[{"cnp", " ", 
             FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}], "-", 
            RowBox[{"g", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"n", 
                FractionBox["1", "z"]}], "-", 
               RowBox[{"n", 
                FractionBox[
                 RowBox[{"(", 
                  RowBox[{"z", "-", "1"}], ")"}], "z"], 
                FractionBox["\[CapitalRho]n", "\[CapitalRho]0"]}]}], 
              ")"}]}]}], ")"}]}], "-", 
         RowBox[{"2", "m", " ", "\[Rho]np"}]}]}], "\[IndentingNewLine]", 
       "}"}], "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"List", " ", "of", " ", "replacement", " ", "rules"}], ",", 
         " ", 
         RowBox[{
         "just", " ", "to", " ", "make", " ", "it", " ", "less", " ", 
          "difficult", " ", "to", " ", "write"}], ",", " ", 
         RowBox[{"check", " ", "and", " ", 
          RowBox[{"maintain", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalRho]0", "\[Rule]", 
         RowBox[{"1", "-", "\[Rho]n", "-", "\[Rho]p"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalRho]n", "\[Rule]", " ", 
         RowBox[{"\[Rho]n", "-", "\[Rho]nn", "-", "\[Rho]np"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\[CapitalRho]p", "\[Rule]", 
         RowBox[{"\[Rho]p", "-", "\[Rho]pp", "-", "\[Rho]np"}]}]}], 
       "\[IndentingNewLine]", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "List", " ", "here", " ", "your", " ", "hypotheses", " ", "about", " ", 
     "the", " ", "parameters"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hyps", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"0", "<", "z"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "<", "n", "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "<", "b", "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "<", "\[Delta]", "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "<", "m", "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "<", "g", "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "<", "cn", "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "<", "cp", "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "<", "cnp", "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"0", "<", "cpn", "<", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"hyps", "=", 
     RowBox[{"And", "@@", "hyps"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6460499719195013`*^9, 3.646049993899124*^9}, {
   3.6460503186692753`*^9, 3.646050360003139*^9}, 3.646050435759927*^9, {
   3.64605079210527*^9, 3.6460508004978867`*^9}, {3.6460511550264473`*^9, 
   3.646051158784691*^9}, {3.646052205861375*^9, 3.646052370503414*^9}, {
   3.646052462146039*^9, 3.646052472720562*^9}, {3.6460547656375303`*^9, 
   3.64605477417774*^9}, {3.646115595907895*^9, 3.646115606833465*^9}, {
   3.646124958076682*^9, 3.6461250990348043`*^9}, {3.646125796074648*^9, 
   3.646125927639737*^9}, {3.646126008820466*^9, 3.646126084051412*^9}, {
   3.64612617454076*^9, 3.6461262285556192`*^9}, {3.6461262616402197`*^9, 
   3.64612635027407*^9}, {3.646126974201952*^9, 3.64612701481424*^9}, {
   3.64612705980895*^9, 3.646127068019211*^9}, {3.6461271136320467`*^9, 
   3.646127391780615*^9}, {3.646127435632516*^9, 3.646127450653584*^9}, {
   3.6461274875541697`*^9, 3.646127826058065*^9}, {3.64612785979956*^9, 
   3.64612788127763*^9}, {3.6461280365202923`*^9, 3.646128455525692*^9}, {
   3.6461286215463123`*^9, 3.646128660677773*^9}, {3.646128760157545*^9, 
   3.646128763263132*^9}, {3.646128931042512*^9, 3.646128945853454*^9}, {
   3.646128977535159*^9, 3.64612906535793*^9}, {3.6461291230327873`*^9, 
   3.646129211753611*^9}, {3.646129520499702*^9, 3.646129527851769*^9}, {
   3.646134099404627*^9, 3.646134132941598*^9}, {3.646134232169511*^9, 
   3.646134233205948*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Equilibria", " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6460516975640497`*^9, 3.646051698710929*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Solve", " ", "the", " ", "system", " ", "for", " ", "all", " ", 
      "derivatives"}], " ", "\[Equal]", " ", "0"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"might", " ", "be", " ", "long", " ", "with", " ", "non"}], 
       "-", 
       RowBox[{
        RowBox[{"linearities", ".", " ", "`Might"}], " ", "even", " ", 
        "be"}]}], ".."}], " ", "super", " ", 
     RowBox[{"long", ".", " ", 
      RowBox[{"Don", "'"}]}], "t", " ", "try", " ", "too", " ", "much", " ", 
     "if", " ", "it", " ", 
     RowBox[{"is", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"eqs", " ", "=", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Equal]", "0"}], "&"}], "/@", "ODEs"}], ",", 
      "varNames", ",", "Reals"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "@", "\"\<Solved equilibria.\>\""}], 
    "\[IndentingNewLine]", 
    RowBox[{"EmitSound", "@", "done"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6460514724545317`*^9, 3.646051482967823*^9}, 
   3.646051595807214*^9, {3.6460516606151237`*^9, 3.646051723117976*^9}, {
   3.646129501045539*^9, 3.646129507590494*^9}, {3.646132818497959*^9, 
   3.646132820149082*^9}, 3.6461342513485203`*^9, 3.646135451989689*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{"Simplify", " ", "the", " ", 
    RowBox[{"result", ".", " ", "`Might"}], " ", "be", " ", "long", " ", "as",
     " ", 
    RowBox[{"well", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"eqs", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"eqs", ",", "hyps"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Print", "@", "\"\<Simplified equilibria.\>\""}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.646050471261271*^9, 3.646050492476492*^9}, {
   3.646050523855364*^9, 3.64605061884824*^9}, {3.6460506732769613`*^9, 
   3.646050751875999*^9}, {3.646050797778308*^9, 3.646050881652141*^9}, {
   3.6460509126345987`*^9, 3.646050932295638*^9}, {3.646051170668963*^9, 
   3.646051295127626*^9}, {3.646051348463045*^9, 3.646051458207292*^9}, {
   3.646051559299308*^9, 3.64605159389544*^9}, {3.6460531174276123`*^9, 
   3.646053119192697*^9}, 3.6461354607024508`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{"Print", " ", "the", " ", 
    RowBox[{"result", ".", " ", "Might"}], " ", "be", " ", "huge", " ", "if", 
    " ", "you", " ", 
    RowBox[{"haven", "'"}], "t", " ", "defined", " ", "yet", " ", "some", " ",
     "relevant", " ", "recurring", " ", 
    RowBox[{"values", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"nEqs", "=", 
    RowBox[{"Length", "@", "eqs"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"ToString", "@", "nEqs"}], " ", "<>", 
      "\"\< equilibria found:\>\""}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"TableForm", "@", "eqs"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6460525289411583`*^9, 3.646052544358671*^9}, {
   3.6461156635356092`*^9, 3.646115693458229*^9}, 3.646135464148514*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"(*", " ", 
    RowBox[{"Positivity", " ", "for", " ", "the", " ", "equilibria"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Since", " ", "we", " ", "are", " ", "biologist"}], ",", " ", 
     RowBox[{
     "I", " ", "guess", " ", "that", " ", "*", "all", "*", " ", "variables", 
      " ", "in", " ", "varNames", " ", "must", " ", "be", " ", "positive", 
      " ", "in", " ", "any", " ", 
      RowBox[{"case", ".", " ", "Therefore"}]}], ",", " ", 
     RowBox[{"equilibria", " ", "just", " ", 
      RowBox[{"don", "'"}], "t", " ", "exist", " ", "if", " ", "they", " ", 
      "are", " ", 
      RowBox[{"negative", ".", " ", "Here"}], " ", "are", " ", "the", " ", 
      "conditions", " ", "of", " ", "positivity", " ", "of", " ", "your", " ",
       "equilibria"}], ",", " ", 
     RowBox[{
     "which", " ", "one", " ", "might", " ", "be", " ", "interested", " ", 
      "in", " ", 
      RowBox[{"interpreting", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Choose", " ", "an", " ", "equilibrium", " ", "from", " ", "the", " ", 
     "ones", " ", 
     RowBox[{"found", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq", " ", "=", "2"}], ";", "\[IndentingNewLine]", 
    RowBox[{"eq", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       "&"}], "/@", 
      RowBox[{
      "eqs", "\[LeftDoubleBracket]", "eq", "\[RightDoubleBracket]"}]}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "here", " ", "is", " ", "the", " ", "condition", " ", "of", " ", 
      "positivity"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"condition", "=", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], "/@", "eq"}], ")"}]}],
       "&&", "hyps"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"fiddle", "-", "faddle"}], ",", " ", 
      RowBox[{"work", " ", "on", " ", "it"}], ",", " ", 
      RowBox[{"Mma", " ", 
       RowBox[{"you", "'"}], "re", " ", "the", " ", 
       RowBox[{"best", " ", ":", "P"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"condition", "=", 
     RowBox[{"Reduce", "@", "condition"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"condition", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"condition", ",", "hyps"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"And", " ", 
       RowBox[{"that", "'"}], "s", " ", "the", " ", 
       RowBox[{"result", ".", " ", 
        RowBox[{"True", "?", " ", "The"}]}], " ", "equilibrium", " ", 
       "always", " ", 
       RowBox[{"exist", ".", " ", 
        RowBox[{"False", "?", " ", "You"}]}], " ", 
       RowBox[{"won", "'"}], "t", " ", "ever", " ", "be", " ", 
       RowBox[{"bothered", ".", " ", "An"}], " ", 
       RowBox[{"expression", "?", " ", "It"}], " ", "is", " ", "the", " ", 
       "condition", " ", "of", " ", 
       RowBox[{"positivity", ".", " ", "Understanding"}], " ", "it"}], ",", 
      RowBox[{
      "interpreting", " ", "it", " ", "or", " ", "writing", " ", "it", " ", 
       "better", " ", "is", " ", "your", " ", "job", " ", 
       RowBox[{"now", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "condition"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.646051744816559*^9, 3.646052193255231*^9}, {
   3.646052423213765*^9, 3.646052911144022*^9}, {3.646058924375819*^9, 
   3.646058924660926*^9}, 3.6461354688184566`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Stability", " ", "of", " ", "the", " ", "equilibria"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.646052941641962*^9, 3.646052947255498*^9}, {
  3.646054391847287*^9, 3.64605439616401*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", "EigenValues", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Compute", " ", "the", " ", "Jacobian", " ", "matrix", " ", "for", " ", 
    "your", " ", "system"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Jac", "=", 
     RowBox[{"Outer", "[", 
      RowBox[{"D", ",", "ODEs", ",", "varNames"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Simplify", " ", "it"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Jac", " ", "=", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"Jac", ",", " ", "hyps"}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"And", " ", "there", " ", "it", " ", "is"}], ".."}], " ", 
     "`like", " ", 
     RowBox[{"it", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "@", "Jac"}]}]}]], "Input",
 CellChangeTimes->{{3.6460529524013844`*^9, 3.646052972290579*^9}, {
   3.6460530148061934`*^9, 3.64605310230068*^9}, {3.646053132646193*^9, 
   3.646053150404344*^9}, {3.646054401059116*^9, 3.646054407688994*^9}, 
   3.646134320024027*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "To", " ", "get", " ", "the", " ", "eigenValues", " ", "associated", " ", 
     "with", " ", "an", " ", "equilibrium"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"one", " ", "must", " ", "first"}], ".."}], " ", "choose", " ", 
     "an", " ", 
     RowBox[{"equilibrium", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"eq", " ", "=", "2"}], ";", "\[IndentingNewLine]", 
   RowBox[{"eq", "=", 
    RowBox[{"eqs", "\[LeftDoubleBracket]", "eq", "\[RightDoubleBracket]"}]}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "..", " ", "evaluate", " ", "the", " ", "Jacobian", " ", "matrix", " ", 
     "in", " ", "this", " ", "very", " ", 
     RowBox[{"point", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"oneJac", "=", 
    RowBox[{"Jac", "/.", "eq"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"oneJac", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"oneJac", ",", "hyps"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"by", " ", "the", " ", "way"}], ",", " ", 
       RowBox[{
       "check", " ", "it", " ", "out", " ", "if", " ", "you", " ", "feel", 
        " ", "curiosity"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"if", " ", "you", " ", 
        RowBox[{"don", "'"}], "t"}], ",", " ", 
       RowBox[{
        RowBox[{"add", " ", "a", " ", "`"}], ";", 
        RowBox[{
        "`", " ", "not", " ", "to", " ", "spoil", " ", "your", " ", "output", 
         " ", "with", " ", "intermediate", " ", "results"}]}]}], ")"}]}], " ",
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixForm", "@", "oneJac"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "..", " ", "the", " ", "eigenValues", " ", "you", " ", "are", " ", 
       "looking", " ", "for", " ", "are", " ", "the", " ", "eigenValues", " ",
        "of", " ", "this", " ", 
       RowBox[{"matrix", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "eigV"}], " ", "=", " ", 
    RowBox[{"Eigenvalues", "@", "oneJac"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"here", " ", "they", " ", 
      RowBox[{"are", ".", " ", "Yep"}]}], ",", " ", 
     RowBox[{"they", " ", "might", " ", "be", " ", "awful"}], ",", " ", 
     RowBox[{"but", " ", "hey"}], ",", " ", 
     RowBox[{"they", " ", 
      RowBox[{"can", "'"}], "t", " ", "help", " ", "being", " ", "what", " ", 
      "they", " ", 
      RowBox[{"are", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{" ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "forget", " ", "about", " ", "it", " ", "if", " ", "it", " ", "lags", 
        " ", "too", " ", "much"}], ")"}], ",", " ", 
      RowBox[{
      "it", " ", "is", " ", "not", " ", "essential", " ", "for", " ", "the", 
       " ", "plots"}]}], ")"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"eigV", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"eigV", ",", "hyps"}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.646053409228643*^9, 3.646053783884305*^9}, {
   3.6460542062290497`*^9, 3.6460542628158503`*^9}, {3.646054294205538*^9, 
   3.6460543775826073`*^9}, {3.646054627719338*^9, 3.646054630029344*^9}, {
   3.646056129362979*^9, 3.6460561418709803`*^9}, {3.646056243896673*^9, 
   3.646056320148951*^9}, {3.646058929218112*^9, 3.6460589294609337`*^9}, 
   3.646135474591145*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{"Stability", " ", "of", " ", "the", " ", 
    RowBox[{"equilibrium", ":", " ", 
     RowBox[{
     "it", " ", "is", " ", "stable", " ", "and", " ", "attractive", " ", 
      "iif", " ", "all", " ", "the", " ", "eigenValues", " ", "are", " ", 
      "negative", " ", 
      RowBox[{"(", 
       RowBox[{
       "or", " ", "their", " ", "real", " ", "part", " ", "if", " ", "they", 
        " ", "are", " ", "complex", " ", "numbers"}], ")"}]}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Get", " ", "the", " ", "real", " ", "part", " ", "of", " ", "the", " ", 
    "eigenValues"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"realPart", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Re", "/@", "eigV"}], ",", "hyps"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"condition", " ", "of", " ", "stability"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"condition", "=", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "<", "0"}], "&"}], "/@", "realPart"}], ")"}]}], "&&", 
     "hyps"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Work", " ", "on", " ", "it", " ", "and", " ", "print", " ", "it"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"condition", "=", 
    RowBox[{"Reduce", "@", "condition"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"condition", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"condition", ",", "hyps"}], "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{
     RowBox[{"just", " ", "like", " ", "last", " ", 
      RowBox[{"time", ":", " ", 
       RowBox[{
       "False", " ", "means", " ", "your", " ", "equilibrium", " ", "will", 
        " ", "never", " ", "be", " ", "stable"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"True", " ", "means", " ", 
        RowBox[{"it", "'"}], "ll", " ", "always", " ", 
        RowBox[{"be", ".", " ", "Anything"}], " ", "else", " ", "is"}], 
       ".."}], " ", "the", " ", "condition", " ", "of", " ", "stability", " ",
       "of", " ", "this", " ", 
      RowBox[{"equilibrium", ".", " ", "Understand"}], " ", "it"}], ",", " ", 
     
     RowBox[{"think", " ", "about", " ", "it"}], ",", " ", 
     RowBox[{"work", " ", "on", " ", "it"}], ",", " ", 
     RowBox[{"it", " ", "might", " ", "be", " ", "worth", " ", 
      RowBox[{"it", " ", ":"}]}]}], ")"}], "*)"}], "*)"}]], "Input",
 CellChangeTimes->{{3.646054384388262*^9, 3.646054387150454*^9}, {
   3.6460544172326803`*^9, 3.6460545321944647`*^9}, {3.646054638749689*^9, 
   3.646054656312858*^9}, {3.646054726659976*^9, 3.64605473278829*^9}, {
   3.646055181052986*^9, 3.6460551946596947`*^9}, {3.64605522900766*^9, 
   3.64605529496345*^9}, {3.646055338640669*^9, 3.646055561390746*^9}, {
   3.646055936766762*^9, 3.6460559385371037`*^9}, 3.646135478973299*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"This", " ", "is", " ", 
     RowBox[{"it", ".", " ", "We"}], " ", "know", " ", "a", " ", "lot", " ", 
     "of", " ", "things", " ", "about", " ", "your", " ", "system", " ", 
     RowBox[{"now", ".", " ", "But"}], " ", "we", " ", 
     RowBox[{"can", "'"}], "t", " ", "*", "feel", "*", " ", 
     RowBox[{"it", ".", " ", "The"}], " ", "best", " ", "way", " ", "to", " ",
      "feel", " ", "it", " ", "is", " ", "to", " ", "plot", " ", "it"}], ",", 
    " ", 
    RowBox[{"is", " ", "it", " ", 
     RowBox[{"not", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"So", " ", 
    RowBox[{"PLOOT", "!!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Choose", " ", "your", " ", "favorite", " ", "colors", " ", "here"}], ",",
     " ", 
    RowBox[{"one", " ", "for", " ", "each", " ", 
     RowBox[{"variable", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"cols", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Darker", "@", "Green"}], ",", "Red", ",", "Blue", ",", "Orange",
      ",", 
     RowBox[{"Lighter", "@", "Purple"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.646056086439373*^9, 3.64605612302286*^9}, {
  3.646056376550808*^9, 3.646056550145488*^9}, {3.646056581966898*^9, 
  3.646056601098112*^9}, {3.646056681900298*^9, 3.646056694114368*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "build", " ", "the", " ", "actual", " ", "system", " ", "of", " ", 
    "inequations", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dirty", " ", "pasting", " ", "and", " ", "replacing"}], ",", 
      " ", "sorry"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"stringNames", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "@", 
        RowBox[{"SymbolName", "@", "#"}]}], "&"}], "/@", "varNames"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lhs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "<>", "\"\<f'[t]\>\""}], "&"}], "/@", "stringNames"}], "//",
       "ToExpression"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"replace", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "#", "<>", "\"\<\[Rule]\>\"", "<>", "#", "<>", "\"\<f[t]\>\""}], 
        "&"}], "/@", "stringNames"}], "//", "ToExpression"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rhs", "=", 
     RowBox[{"ODEs", " ", "/.", "replace"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"system", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "\[Equal]", "#2"}], "&"}], "@@@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"lhs", ",", "rhs"}], "}"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"replace", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"ToExpression", "[", 
         RowBox[{"#1", "<>", "\"\<f\>\""}], "]"}], "\[Rule]", "#2"}], "&"}], "@@@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"stringNames", ",", "varNames"}], "}"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"system", "=", 
     RowBox[{"system", "/.", "replace"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"build", " ", "the", " ", "initial", " ", "conditions", " ", 
     RowBox[{"(", 
      RowBox[{"same", ",", " ", "sorry"}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lhs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "<>", "\"\<[0]\>\""}], "&"}], "/@", "stringNames"}], "//",
       "ToExpression"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rhs", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "<>", "\"\<0\>\""}], "&"}], "/@", "stringNames"}], "//", 
      "ToExpression"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inits", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "\[Equal]", "#2"}], "&"}], "@@@", 
      RowBox[{"Transpose", "@", 
       RowBox[{"{", 
        RowBox[{"lhs", ",", "rhs"}], "}"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "and", " ", "this", " ", "is", " ", "all", " ", "NDSolve", " ", "will", 
      " ", 
      RowBox[{"need", ".", " ", "Should"}], " ", "you", " ", "feel", " ", 
      "curious", " ", "about", " ", "it"}], ",", " ", 
     RowBox[{
     "check", " ", "out", " ", "the", " ", "result", " ", "in", " ", "a", " ", 
      RowBox[{"TableForm", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"system", "=", 
     RowBox[{"system", "~", "Join", "~", "inits"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"TableForm", "@", "system"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQvePe778+Wq8dXwUwMPgC6RhzP3kQPSOgUgFER8zP
tgDR1z7nO4DoFYGy7iA6S+2eN4hel7Y1CUTfmjMlE0Q7MrbkgugTIf4FINrg
1OkGEP3pct4EEN0x+9I0ED3XZsl0EP2G22IuiJbzE1oCNj81cAWIVrrcsRpE
3+n+ux5El83y3gCiW0XnbQPRVlaK28Hqq87tA9E/ra8+AdHWLt9fgWgpC9Y/
IPqG9UpWPyB9YOMdMP1I7KQ5iD4zU8IWRB/JjmFKAvlXfwc7iG56F9APok/w
rpgNojU01daC6KkyuutAdMbkHZtANOtW0VMg+uFSz3Mguqya/S+IZnR4ezIT
SJdIsVwE0QBjVqE0
  "]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"First", ":", " ", 
   RowBox[{"variables", " ", "against", " ", "time"}]}], " ", "*)"}]], "Input",\

 CellChangeTimes->{{3.6461077561734543`*^9, 3.646107763672249*^9}, 
   3.6461154113065643`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Now", " ", "solve", " ", "it", " ", "numerically", " ", "and", " ", 
     "plot", " ", 
     RowBox[{"it", "!"}], " ", "All", " ", "of", " ", "this", " ", "will", 
     " ", "happen", " ", "inside", " ", "a", " ", "Manipulate"}], ",", " ", 
    RowBox[{
    "so", " ", "that", " ", "you", " ", "will", " ", "be", " ", "able", " ", 
     "to", " ", "easily", " ", "play", " ", "around", " ", "with", " ", "the",
      " ", "time", " ", "of", " ", "simulation"}], ",", " ", 
    RowBox[{"initial", " ", "conditions", " ", "and", " ", 
     RowBox[{"parameters", ".", " ", "This"}], " ", "has", " ", "a", " ", 
     RowBox[{"cost", ":", " ", 
      RowBox[{
       RowBox[{"it", "'"}], "ll", " ", "all", " ", "big", " ", "one", " ", 
       "big", " ", "call", " ", "to", " ", "the", " ", "function", " ", 
       RowBox[{"Manipulate", ".", " ", 
        RowBox[{"Don", "'"}]}], "t", " ", "be", " ", "afraid"}]}]}], ",", " ", 
    RowBox[{
    "I", " ", "am", " ", "afraid", " ", "this", " ", "is", " ", "just", " ", 
     "classical", " ", 
     RowBox[{"Mathematica", "'"}], "s", " ", "scripting", " ", 
     RowBox[{"paradigm", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NDSolution", "=", 
          RowBox[{"varNames", "/.", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Numerically", " ", "solve", " ", "the", " ", 
             RowBox[{"ODE", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"NDSolve", "[", 
             RowBox[{"SYSTEM", ",", "varNames", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}], 
            "\[IndentingNewLine]", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Numerically", " ", "find", " ", "the", " ", 
           RowBox[{"equilibria", ":", " ", 
            RowBox[{"(", "TODO", ")"}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"eqs", "=", "SYSTEM"}]}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "also", " ", "check", " ", "the", " ", "associated", " ", 
          "eigenValues", " ", "to", " ", "test", " ", "for", " ", 
          "stability"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"eig", "=", 
          RowBox[{
           RowBox[{"JAC", "/.", 
            RowBox[{"EQUILIBRIA", "\[LeftDoubleBracket]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"eqID", "\[NotEqual]", "0"}], ",", "eqID", ",", "1"}], 
              "]"}], "\[RightDoubleBracket]"}]}], "//", "Eigenvalues"}]}], 
         "*)"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TableForm", "[", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Plot", " ", "the", " ", "trajectories", " ", 
           RowBox[{"(", 
            RowBox[{
            "they", " ", "are", " ", "interpolations", " ", "functions", " ", 
             "approximating", " ", "the", " ", "solutions"}], ")"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "t", "]"}], "&"}], "/@", "NDSolution"}], "//",
             "Evaluate"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "cols"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"800", ",", "500"}], "}"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"AxesLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"t", ",", "variable"}], "}"}]}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"PlotLegends", "\[Rule]", "varNames"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "height"}], "}"}]}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"(*", " ", 
            RowBox[{
            "add", " ", "horizontal", " ", "lines", " ", "to", " ", 
             "represent", " ", "the", " ", "choosen", " ", "equilibrium"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{",", 
            RowBox[{"Epilog", "\[Rule]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"eqID", "\[Equal]", "0"}], ",", 
               RowBox[{"Point", "[", 
                RowBox[{"{", "}"}], "]"}], ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"AllTrue", "[", 
                  RowBox[{"eq", ",", 
                   RowBox[{
                    RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}]}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"Here", " ", "are", " ", "the", " ", "lines"}], " ",
                   "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"#1", ",", "Thin", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "#2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"tmax", ",", "#2"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "&"}], "@@@", 
                  RowBox[{"Transpose", "@", 
                   RowBox[{"{", 
                    RowBox[{"cols", ",", "eq"}], "}"}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{"But", " ", 
                   RowBox[{"don", "'"}], "t", " ", "draw", " ", "any", " ", 
                   "of", " ", "them", " ", "if", " ", "the", " ", 
                   "equilibrium", " ", "is", " ", "negative"}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"Red", ",", 
                   RowBox[{"Text", "[", 
                    RowBox[{"\"\<negative equilibrium\>\"", ",", 
                    RowBox[{".9", 
                    RowBox[{"{", 
                    RowBox[{"tmax", ",", "height"}], "}"}]}]}], "]"}]}], 
                  "}"}]}], "\[IndentingNewLine]", "]"}]}], 
              "\[IndentingNewLine]", "]"}]}]}], "*)"}], "\[IndentingNewLine]",
           "]"}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Report", " ", "eigenvalues", " ", "associated", " ", "with", " ",
              "the", " ", "choosen", " ", 
             RowBox[{"equilibrium", "."}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"eqID", "\[NotEqual]", "0"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{"\"\<\[Lambda]\>\"", "<>", 
                   RowBox[{"ToString", "@", "#1"}], "<>", "\"\<=\>\"", "<>", 
                   RowBox[{"ToString", "@", "#2"}]}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Re", "[", "#2", "]"}], "\[GreaterEqual]", "0"}], 
                    ",", 
                    RowBox[{"Darker", "[", 
                    RowBox[{"Green", ",", 
                    FractionBox["2", "3"]}], "]"}], ",", 
                    RowBox[{"Darker", "@", "Red"}]}], "]"}]}], "]"}], "&"}], "@@@", 
               RowBox[{"Transpose", "@", 
                RowBox[{"{", 
                 RowBox[{"varNames", ",", "eig"}], "}"}]}]}], ",", 
              RowBox[{"{", "}"}]}], "]"}], "}"}]}], "*)"}], 
         "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Things", " ", "you", " ", "can", " ", 
       RowBox[{"tweak", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"This", " ", "place", " ", "is", " ", 
       RowBox[{"yours", ".", " ", "The"}], " ", "correct", " ", "form", " ", 
       "for", " ", "defining", " ", "a", " ", "manipulator", " ", "is", " ", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"variable", " ", "name"}], ",", " ", 
            RowBox[{"default", " ", "value"}], ",", " ", "legend"}], "}"}], 
          ",", " ", 
          RowBox[{"min", " ", "value"}], ",", " ", 
          RowBox[{"max", " ", "value"}]}], "}"}], ".", " ", "Just"}], " ", 
       "make", " ", "sure", " ", "that", " ", "no", " ", "parameter", " ", 
       "is", " ", "missing", " ", "since", " ", "NDSolve", " ", "needs", " ", 
       "a", " ", "numerical", " ", "value", " ", "for", " ", "everything", 
       " ", "in", " ", "order", " ", "to", " ", "get", " ", "a", " ", 
       "numerical", " ", 
       RowBox[{"solution", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"simulating", " ", "time"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmax", ",", ".1", ",", "\"\<duration\>\""}], "}"}], ",", "0",
        ",", "1"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     "Delimiter", " ", ",", "\"\<initials\>\"", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Rho]n0", ",", ".4", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Rho]\), SubscriptBox[\(N\), \
\(0\)]]\)\>\""}], "}"}], ",", "0", ",", "1"}], "}"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Rho]p0", ",", ".5", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Rho]\), SubscriptBox[\(P\), \
\(0\)]]\)\>\""}], "}"}], ",", "0", ",", "1"}], "}"}], "\[IndentingNewLine]", 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Rho]nn0", ",", ".6", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Rho]\), SubscriptBox[\(NN\), \(0\)]]\)\>\
\""}], "}"}], ",", "0", ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Rho]pp0", ",", ".3", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Rho]\), SubscriptBox[\(PP\), \(0\)]]\)\>\
\""}], "}"}], ",", "0", ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Rho]np0", ",", ".2", ",", 
         "\"\<\!\(\*SubscriptBox[\(\[Rho]\), SubscriptBox[\(NP\), \(0\)]]\)\>\
\""}], "}"}], ",", "0", ",", "1"}], "}"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", ",", "Delimiter", " ", ",", "\"\<parameters\>\"", 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Delta]", ",", ".1", ",", "\"\<\[Delta]\>\""}], "}"}], ",", 
       "0", ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", ".8", ",", "\"\<b\>\""}], "}"}], ",", "0", ",", 
       "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g", ",", ".1", ",", "\"\<g\>\""}], "}"}], ",", "0", ",", 
       "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", ".2", ",", "\"\<m\>\""}], "}"}], ",", "0", ",", 
       "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "cn", ",", ".2", ",", "\"\<\!\(\*SubscriptBox[\(c\), \(N\)]\)\>\""}], 
        "}"}], ",", "0", ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "cp", ",", ".2", ",", "\"\<\!\(\*SubscriptBox[\(c\), \(P\)]\)\>\""}], 
        "}"}], ",", "0", ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "cnp", ",", ".05", ",", 
         "\"\<\!\(\*SubscriptBox[\(c\), \(NP\)]\)\>\""}], "}"}], ",", "0", 
       ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "cpn", ",", ".2", ",", 
         "\"\<\!\(\*SubscriptBox[\(c\), \(PN\)]\)\>\""}], "}"}], ",", "0", 
       ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"z", ",", "4", ",", "\"\<z\>\""}], "}"}], ",", "0", ",", "10",
        ",", "1"}], "}"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", "\"\<n\>\""}], "}"}], ",", "0", ",", 
       "1"}], "}"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
     "Delimiter", ",", "\"\<plot\>\"", "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"height", ",", "1", ",", "\"\<ymax\>\""}], "}"}], ",", "0", 
       ",", "100"}], "}"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Choose", " ", "the", " ", "equilibrium", " ", 
       RowBox[{"you", "'"}], "d", " ", "like", " ", "to", " ", 
       RowBox[{"see", ".", " ", "Set"}], " ", "it", " ", "to", " ", "0", " ", 
       "not", " ", "to", " ", "see", " ", 
       RowBox[{"any", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"eqID", ",", "2", ",", "\"\<equilibrium\>\""}], "}"}], ",", 
        "0", ",", "nEqs", ",", "1"}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"That", "'"}], "s", " ", 
      RowBox[{"it", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"SYSTEM", "\[Rule]", "system"}], ",", 
     RowBox[{"JAC", "\[Rule]", "Jac"}]}], "}"}], 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"this", " ", "is", " ", "weird", " ", "I", " ", "know"}], ",", 
     " ", 
     RowBox[{
     "tell", " ", "me", " ", "if", " ", "you", " ", "find", " ", "better"}]}],
     " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.646134450088377*^9, 3.646134586353785*^9}, {
   3.646134627873158*^9, 3.646134834747361*^9}, {3.646134944618935*^9, 
   3.646135029217436*^9}, {3.6461350962346497`*^9, 3.646135126591889*^9}, {
   3.6461351776660547`*^9, 3.646135222071291*^9}, {3.646135333425954*^9, 
   3.646135363337859*^9}, {3.6461355125636597`*^9, 3.646135516292794*^9}, {
   3.6461355527105427`*^9, 3.646135584216558*^9}, 3.646135635489786*^9}]
},
WindowSize->{1600, 900},
WindowMargins->{{-10, Automatic}, {-10, -37}},
Magnification->1.25,
FrontEndVersion->"10.0 for Linux x86 (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4364, 101, 464, "Input"],
Cell[4925, 123, 10980, 252, 1048, "Input"],
Cell[15908, 377, 200, 4, 89, "Input"],
Cell[16111, 383, 1396, 35, 139, "Input"],
Cell[17510, 420, 960, 19, 89, "Input"],
Cell[18473, 441, 859, 19, 114, "Input"],
Cell[19335, 462, 3734, 85, 414, "Input"],
Cell[23072, 549, 279, 6, 80, "Input"],
Cell[23354, 557, 1262, 31, 267, "Input"],
Cell[24619, 590, 3564, 84, 455, "Input"],
Cell[28186, 676, 3033, 70, 392, "Input"],
Cell[31222, 748, 1500, 34, 267, "Input"],
Cell[32725, 784, 3897, 111, 517, "Input"],
Cell[36625, 897, 242, 6, 47, "Input"],
Cell[36870, 905, 15416, 357, 2347, "Input"]
}
]
*)

(* End of internal cache information *)
